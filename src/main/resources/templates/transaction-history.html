<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Riwayat Transaksi - Kasir</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://unpkg.com/flowbite@1.7.0/dist/flowbite.min.css" rel="stylesheet" />
</head>
<body>
<nav class="bg-gray-800 text-white">
  <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
    <div class="flex items-center space-x-6">
      <span class="font-semibold">Sistem Kasir</span>
      <a class="text-gray-300 hover:text-white" th:href="@{/kasir/dashboard}">POS</a>
      <a class="text-white font-medium" th:href="@{/kasir/history}">Riwayat Transaksi</a>
    </div>
    <div class="flex items-center space-x-3">
      <span class="text-gray-200">Welcome, <strong th:text="${username}"></strong>!</span>
      <form th:action="@{/logout}" method="post"><button type="submit" class="text-sm bg-transparent border border-white text-white rounded px-3 py-1">Logout</button></form>
    </div>
  </div>
</nav>

<div class="max-w-6xl mx-auto mt-6 px-4">
  <h2 class="text-xl font-semibold mb-4">Riwayat Transaksi</h2>
  <div th:if="${param.checkout_success}" class="bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded mb-4" th:text="'Transaksi ' + ${param.checkout_success} + ' berhasil diproses!'"></div>

  <div class="overflow-x-auto bg-white shadow rounded">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-800 text-white">
        <tr>
          <th class="px-4 py-2 text-left">ID Transaksi</th>
          <th class="px-4 py-2 text-left">Tanggal</th>
          <th class="px-4 py-2 text-left">Total Harga</th>
          <th class="px-4 py-2 text-left">Kasir</th>
          <th class="px-4 py-2 text-left">Aksi</th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-gray-100">
        <tr th:each="tx : ${transactions}" th:classappend="${param.checkout_success != null and #strings.equals(tx.id, param.checkout_success[0]) ? 'bg-green-50' : ''}">
          <td class="px-4 py-2" th:text="${tx.id}"></td>
          <td class="px-4 py-2" th:text="${#temporals.format(tx.transactionDate, 'dd-MM-yyyy HH:mm')}"></td>
          <td class="px-4 py-2" th:text="${'Rp ' + #numbers.formatDecimal(tx.totalPrice, 0, 'POINT', 0, 'COMMA')}"></td>
          <td class="px-4 py-2" th:text="${tx.user.username}"></td>
          <td class="px-4 py-2">
            <a th:href="@{/kasir/transaction/pdf/{id}(id=${tx.id})}" class="inline-block bg-blue-500 hover:bg-blue-600 text-white text-sm rounded px-3 py-1" target="_blank">Cetak Struk</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

    <script src="https://unpkg.com/flowbite@1.7.0/dist/flowbite.bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lucide@latest/dist/lucide.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        if (window.lucide) { lucide.createIcons(); }
      });
    </script>
</body>
</html>
